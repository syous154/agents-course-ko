# 행동: 에이전트가 환경과 상호작용하도록 활성화하기

<Tip>
 이 섹션에서는 AI 에이전트가 환경과 상호작용하기 위해 취하는 구체적인 단계를 살펴봅니다.

 행동이 어떻게 표현되는지(JSON 또는 코드를 사용하여), 중지 및 구문 분석 접근 방식의 중요성, 그리고 다양한 유형의 에이전트를 소개합니다.
</Tip>

행동은 **AI 에이전트가 환경과 상호작용하기 위해 취하는 구체적인 단계**입니다.

정보를 얻기 위해 웹을 탐색하든 물리적 장치를 제어하든, 각 행동은 에이전트에 의해 실행되는 의도적인 작업입니다.

예를 들어, 고객 서비스를 지원하는 에이전트는 고객 데이터를 검색하거나, 지원 문서를 제공하거나, 문제를 인간 담당자에게 전달할 수 있습니다.

## 에이전트 행동의 유형

행동을 다르게 취하는 여러 유형의 에이전트가 있습니다:

| 에이전트 유형         | 설명                                                                                             |
|------------------------|--------------------------------------------------------------------------------------------------|
| JSON 에이전트          | 취할 행동이 JSON 형식으로 지정됩니다.                                                          |
| 코드 에이전트          | 에이전트가 외부에서 해석되는 코드 블록을 작성합니다.                                            |
| 함수 호출 에이전트     | 각 행동에 대해 새로운 메시지를 생성하도록 미세 조정된 JSON 에이전트의 하위 범주입니다.         |

행동 자체는 여러 목적을 수행할 수 있습니다:

| 행동 유형              | 설명                                                                                     |
|--------------------------|------------------------------------------------------------------------------------------|
| 정보 수집                | 웹 검색 수행, 데이터베이스 쿼리, 문서 검색.                                            |
| 도구 사용                | API 호출, 계산 실행, 코드 실행.                                                          |
| 환경 상호작용            | 디지털 인터페이스 조작 또는 물리적 장치 제어.                                          |
| 통신                     | 채팅을 통해 사용자와 소통하거나 다른 에이전트와 협력.                                  |

LLM은 텍스트만 처리하며, 이를 사용하여 취하려는 행동과 도구에 제공할 매개변수를 설명합니다. 에이전트가 제대로 작동하려면, LLM은 완전한 행동을 정의하는 모든 토큰을 방출한 후 새로운 토큰 생성을 중지해야 합니다. 이렇게 하면 LLM에서 에이전트로 제어권이 다시 전달되고, 의도된 형식이 JSON이든 코드든 함수 호출이든 결과가 구문 분석 가능하도록 보장됩니다.

## 중지 및 구문 분석 접근 방식

행동을 구현하는 한 가지 핵심 방법은 **중지 및 구문 분석 접근 방식**입니다. 이 방법은 에이전트의 출력이 구조화되고 예측 가능하도록 보장합니다:

1.  **구조화된 형식으로 생성**:

    에이전트는 의도된 행동을 명확하고 미리 정해진 형식(JSON 또는 코드)으로 출력합니다.

2.  **추가 생성 중단**:

    행동을 정의하는 텍스트가 방출되면, **LLM은 추가 토큰 생성을 중지합니다**. 이는 불필요하거나 잘못된 출력을 방지합니다.

3.  **출력 구문 분석**:

    외부 파서가 형식화된 행동을 읽고, 호출할 도구를 결정하며, 필요한 매개변수를 추출합니다.

예를 들어, 날씨를 확인해야 하는 에이전트는 다음과 같이 출력할 수 있습니다:

```json
Thought: 뉴욕의 현재 날씨를 확인해야 합니다.
Action :
{
  "action": "get_weather",
  "action_input": {"location": "New York"}
}
```
프레임워크는 호출할 함수의 이름과 적용할 인수를 쉽게 구문 분석할 수 있습니다.

이 명확하고 기계가 읽을 수 있는 형식은 오류를 최소화하고 외부 도구가 에이전트의 명령을 정확하게 처리할 수 있도록 합니다.

참고: 함수 호출 에이전트는 지정된 함수가 올바른 인수로 호출되도록 각 행동을 구조화하여 유사하게 작동합니다.
이러한 유형의 에이전트에 대해서는 다음 유닛에서 더 자세히 다룰 것입니다.

## 코드 에이전트

대안적인 접근 방식은 *코드 에이전트*를 사용하는 것입니다.
아이디어는 **단순한 JSON 객체를 출력하는 대신**, 코드 에이전트가 **실행 가능한 코드 블록—일반적으로 Python과 같은 고급 언어—을 생성한다**는 것입니다.

<img src="https://huggingface.co/datasets/agents-course/course-images/resolve/main/en/unit1/code-vs-json-actions.png" alt="코드 에이전트" />

이 접근 방식은 다음과 같은 여러 장점을 제공합니다:

-   **표현력:** 코드는 루프, 조건문, 중첩 함수를 포함한 복잡한 로직을 자연스럽게 표현할 수 있어 JSON보다 더 큰 유연성을 제공합니다.
-   **모듈성 및 재사용성:** 생성된 코드는 다른 행동이나 작업에서 재사용할 수 있는 함수와 모듈을 포함할 수 있습니다.
-   **향상된 디버깅 가능성:** 잘 정의된 프로그래밍 구문을 사용하면 코드 오류를 더 쉽게 감지하고 수정할 수 있습니다.
-   **직접 통합:** 코드 에이전트는 외부 라이브러리 및 API와 직접 통합하여 데이터 처리 또는 실시간 의사 결정과 같은 더 복잡한 작업을 가능하게 합니다.

LLM이 생성한 코드를 실행하는 것은 프롬프트 주입부터 유해한 코드 실행에 이르기까지 보안 위험을 초래할 수 있음을 명심해야 합니다.
그렇기 때문에 기본 안전 장치를 통합하는 `smolagents`와 같은 AI 에이전트 프레임워크를 사용하는 것이 좋습니다.
위험과 완화 방법에 대해 더 자세히 알고 싶다면, [이 전용 섹션을 참조하십시오](https://huggingface.co/docs/smolagents/tutorials/secure_code_execution).

예를 들어, 날씨를 가져오는 작업을 맡은 코드 에이전트는 다음 Python 스니펫을 생성할 수 있습니다:

```python
# 코드 에이전트 예시: 날씨 정보 검색
def get_weather(city):
    import requests
    api_url = f"https://api.weather.com/v1/location/{city}?apiKey=YOUR_API_KEY"
    response = requests.get(api_url)
    if response.status_code == 200:
        data = response.json()
        return data.get("weather", "날씨 정보를 사용할 수 없습니다.")
    else:
        return "오류: 날씨 데이터를 가져올 수 없습니다."

# 함수를 실행하고 최종 답변을 준비합니다.
result = get_weather("New York")
final_answer = f"뉴욕의 현재 날씨는: {result}"
print(final_answer)
```

이 예시에서 코드 에이전트는:

-   **API 호출을 통해** 날씨 데이터를 검색하고,
-   응답을 처리하며,
-   `print()` 함수를 사용하여 최종 답변을 출력합니다.

이 방법은 코드 블록을 명확하게 구분하고 실행이 완료되었음을 알림으로써(여기서는 `final_answer`를 출력하여) **중지 및 구문 분석 접근 방식도 따릅니다**.

---

우리는 행동이 JSON, 코드 또는 함수 호출을 통해 명확하고 구조화된 작업을 실행함으로써 에이전트의 내부 추론과 실제 상호작용을 연결한다는 것을 배웠습니다.

이러한 의도적인 실행은 각 행동이 정확하고 중지 및 구문 분석 접근 방식을 통해 외부 처리를 위한 준비가 되어 있음을 보장합니다. 다음 섹션에서는 에이전트가 환경으로부터 피드백을 캡처하고 통합하는 방법을 알아보기 위해 관찰(Observations)을 탐구할 것입니다.

이후에, 우리는 **마침내 첫 번째 에이전트를 구축할 준비가 될 것입니다!**